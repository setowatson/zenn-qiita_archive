---
title: "Azure Custom Visionで画像認識を成功させる5つの課題と解決策"
emoji: "🤖"
type: "tech"
topics: ["CustomVision", "画像認識", "Azure", "AI"]
published: false
publication_name: "headwaters"
---

# Azure Custom Visionで画像認識を成功させる5つの課題と解決策

Azure Custom Visionは、専門知識がなくても自社独自の画像分類モデルを作成できる便利なサービスです。

しかし、実プロジェクトで高精度な画像認識システムを構築・運用するには、単にモデルを作るだけでなく様々な **現実的な課題** に対処する必要があります。

本記事では、Custom Vision導入における典型的な課題とその解決策について、以下の観点から解説します。

## 📋 目次

1. **画像収集の難しさと克服法**
2. **外観による識別が難しい対象へのアプローチ**
3. **精度評価と改善の実践テクニック**
4. **製品やクラスの拡張への戦略とモデル保守**
5. **Custom Visionで精度が出ない場合の次善策：LLM活用**

技術的な内容を含みますが、できるだけ平易な表現でビジネス担当者にも伝わるようにまとめました。

---

## 1. 画像データ収集の難しさと克服法

### 課題：十分な画像データを集めることの困難さ

画像認識プロジェクト最大の課題の一つは、**十分な画像データを集めること**です。

Azure Custom Visionでは、**1クラスあたり50枚程度**の画像からでもモデル作成を開始できます。これは背後で**転移学習**（事前学習済みモデルの活用）により、比較的少ないデータでもそれなりの精度が出せるためです。

しかし、50枚はあくまでプロトタイプの出発点。実運用で安定した性能を得るには、クラスごとに数百～数千枚規模の画像が望ましいです。

### 解決策1：データ拡張（Data Augmentation）

手持ちの画像に対し、以下の加工を施してバリエーションを増やします：

- 回転・平行移動などの幾何変換
- 明るさ・彩度の変更
- ノイズの追加

**実例：** 30枚の画像を回転やコントラスト調整で300枚に拡張して再学習させたところ、モデルの汎化性能が向上したという報告があります。

### 解決策2：弱教師あり学習

「完全なラベル付きデータが少ない状況で、未ラベルデータや粗いラベル情報を組み合わせて学習する」手法です。

**アプローチ例：**
- Web上から集めた大量の関連画像に簡易的なタグを付けて学習
- モデルの予測結果を人手でチェック・修正しながらデータセットを拡充

### 解決策3：生成AIの活用

昨今の画像生成モデルを用いれば、実物に近い画像やバリエーションを生成しデータ不足を補うことも可能です。

**注意点：** 合成画像の使用はモデルが不自然な特徴を学習するリスクもあるため、あくまで補助的に使うのが安全です。

### 解決策4：転移学習の積極活用

Custom Visionは最初から汎用モデルを基盤として訓練しますが、プロジェクト設定時に自分のタスクに近い**ドメイン**を選択することで、より適した特徴抽出が行われます。

**選択可能なドメイン例：**
- 汎用
- 食品
- ランドマーク
- 小売

---

## 2. 外観による識別が難しい対象へのアプローチ

### 課題：微細な差異の分類（ファイングレイン認識）

外観上ほとんど差がない物体や、構造上カメラに写りづらい特徴をもつ対象を識別したいケースは、画像認識においてかなりの難題です。

人間でも判別が難しいほど似通った外観のもの（例えば微妙な形状違いの製品バリエーションや、そっくりな動植物の種など）は、AIモデルにとっても当然区別が難しくなります。

### 解決策1：「違いが写る写真」をしっかり撮る

判別ポイントとなる特徴が画像内に鮮明に写っていなければモデルは学習できません。

**撮影のポイント：**
- 判別ポイントとなる部分をクローズアップで撮影
- 適切な角度からの写真を準備
- 正面・側面・裏面など複数アングルの画像を用意
- 照明の映り込みで形状が判別しづらい場合は照明を工夫
- 背景の柄が対象と紛らわしいなら無地背景にする

### 解決策2：学習データの戦略的設計

微細な差異にフォーカスしたい場合は、以下のアプローチが有効です：

**データセット設計のポイント：**
- 対象物の向きを統一
- 背景や余計なものを排除
- 判別に不要な変動要素をできるだけ抑える

**具体例：**
- 常に対象を正面から撮った画像に揃える
- 画像内の対象物以外は黒背景にする

**注意点：** この方法はデータの多様性が下がるため過学習リスクも伴います。現実の入力画像ではさまざまな条件で対象が写ることを踏まえ、**差異を強調する画像**と**使用時のバラつきを代表する画像**のバランスに気を配る必要があります。

### 解決策3：2段階の手法

Custom Visionでもオブジェクト検出プロジェクトを作成し、小さな特徴（刻印やロゴ等）をまず検出、その結果に基づき分類するといったパイプラインを組むことも可能です。

---

## 3. モデル精度の評価と改善の実践テクニック

### 課題：精度評価の重要性

モデルを訓練したら、十分な**精度評価**を行い、課題点を洗い出して継続的に改善していくことが重要です。

Custom Visionのポータルでは訓練後にPrecision（適合率）やRecall（再現率）などの指標が表示されますが、これらはあくまで**バリデーションデータ上の性能**であり、過大評価になりがちです。

### 解決策1：テストデータでの検証

必ず別途用意した**テストデータ**でモデルを検証し、現実に近い精度を把握しましょう。

実運用では新しいデータが日々入ってきますから、デプロイ後も定期的にモデルの予測をモニタリングし、精度を測定する仕組みを作るのがおすすめです。

### 解決策2：混同行列の分析

モデルの誤りを分析する際には、**どのクラスをどのクラスと混同しているか**（混同行列）をチェックしましょう。

**対策：**
- **クラス定義の見直し**：2クラスの違いが曖昧であるなら、思い切って一つのクラスに統合
- **データ補強**：違いは明確なはずなのにモデルが混同する場合は、両クラスの画像を追加収集

### 解決策3：アノテーション（ラベリング）の工夫

**補助的なクラスの導入：**
- 「背景」や「その他」といったクラスを導入
- 「対象外」クラスや「その他」タグを作っておく

これにより、明らかにどのカテゴリにも当てはまらない画像はそれとして学習させておけば、モデルは無理に既存クラスへ当てはめようとしなくなります。

### 解決策4：しきい値の調整

Custom Visionの分類モデルは各クラスの確信度（スコア）を出力しますが、標準では最もスコアの高いクラスを予測結果とします。

**改善例：** 「トップの確信度が80%未満なら"不明"とみなす」といったルールを設ける

これにより自信のない予測に基づく誤判定を防ぎ、問題のある入力を人間の確認に回すなどの対処が可能です。

### 解決策5：継続的なフィードバックループ

運用中にモデルが誤ったケースや低信頼度を出力したケースを記録し、その画像に正解ラベルを付けて蓄積します。

そして定期的にそれらを追加学習させることで、モデルは自らの弱点を克服していきます。

---

## 4. 製品やクラスの拡張に備える戦略とモデル保守

### 課題：ビジネスの変化への対応

ビジネスの現場では、扱う製品ラインナップや分類対象が**時間とともに変化・拡大**していくのが常です。

画像認識モデルもこれに対応して**スケーラブルかつ保守的に**運用していく必要があります。

### 解決策1：新クラス追加時の対応

**基本方針：** 新クラスの画像をできる限り収集し、既存クラスのデータと合わせてモデルを再訓練する

**重要なポイント：** 既存クラスの精度が損なわれないようにする

新クラスにばかり注力してデータ不均衡が起きると、他のクラスの予測精度低下を招きかねません。

### 解決策2：階層型の分類戦略

クラスが10程度から50、100と増えるにつれ、モデルの混同リスクや必要データ量は飛躍的に上がります。

**階層型分類の例：**
1. まず大分類（カテゴリ）を予測
2. その結果に応じて細分類モデルを適用

これにより各モデルが扱うクラス数を減らせ、難易度を下げることができます。

### 解決策3：モデルのバージョン管理

Custom Visionプロジェクトでは**Iteration（イテレーション）**という形でモデルのバージョン管理ができます。

改善を施すたびに新しいIterationとして保存し、過去のモデルと精度や混同行列を比較することで、変更の効果を検証できます。

### 解決策4：データのライフサイクル管理

時間の経過とともに古い製品がカタログ落ちしたり、新デザインに切り替わったりと、画像の**陳腐化**が発生します。

**対策：**
- 不要になったクラスや明らかに古いデータは適宜データセットから除外
- 新しい状態を反映した画像をフィードバック
- 現場からのフィードバックを収集する仕組みを構築

### 解決策5：自動化ツールの活用

Azure Custom Visionの**Smart Labeler**機能など自動化ツールも活用しましょう。

Smart Labelerはアップロードした画像に対しモデルが推定したタグを提案してくれる機能で、大量画像のラベリング負荷を減らせます。

---

## 5. 次善策：LLMによる画像理解・説明文生成の活用可能性

### 課題：Custom Visionで精度が出ない場合

場合によっては、どれだけCustom Visionで頑張っても**要求精度に届かない**ケースがあるかもしれません。

- データ不足や対象のあまりの難しさからモデルが安定しない
- プロジェクトの期間や予算が限られ追加のモデル改善が難しい

### 解決策：LLMによる画像解析の活用

**活用可能なLLM例：**
- OpenAIの**GPT-4V (Vision)**
- Googleの**Gemini**（今後リリース予定）

これらを使えば、「訓練済みの特化モデル」を用意しなくても、**一度きりの画像認識タスクをAIに投げて解決する**ことが可能です。

**使用例：** 分類したい画像をそのままGPT-4に送り、「この画像の製品はAとBどちらですか？特徴の違いは〇〇です」と質問すれば、モデルが画像を見て推論し回答を返してくれます。

### LLMの利点

- 人間に近い柔軟さで画像を分析
- 微妙な差異についても説明してくれる可能性
- 「わからない」と回答する柔軟性
- 理由を説明できる点で、人間と協調した運用がしやすい

### LLMの課題

**知識の限界：** これらのモデルが扱えるのは一般に公開されている知識や視覚的パターンが中心であり、**ドメイン固有の新製品**などは知らないことが多いです。

**精度の限界：** 専用に訓練したカスタムモデルほど細部に最適化されているわけではありません。

### コスト考慮

**LLMのコスト例：**
- Azure OpenAIサービス上のGPT-4（Vision機能付き）：1回の画像質問で数円～数十円程度
- 1万枚の画像を処理しただけで数万円規模の費用が発生し得る

**Custom Visionとの比較：**
- Custom Visionのエンドポイント：予測1000件あたり数円～数十円程度
- **高頻度利用には専用モデルの方が圧倒的に経済的**

### 推奨される活用シーン

**低頻度の問い合わせや人手支援的な用途に絞る**のが現実的です。

**具体例：** 社内検品でどうしても判別がつかない画像だけGPT-4Vに送って説明を得る

---

## まとめ

Azure Custom Visionを使った画像認識システムの導入・運用にあたって、直面しがちな課題とその対処法について解説しました。

### 主要なポイント

1. **データ収集の苦労** → データ拡張、弱教師あり学習、転移学習の活用
2. **微妙な対象の見分け方** → 良質な画像確保、ノイズ除去、2段階手法
3. **モデル精度向上の勘所** → テストデータ検証、混同行列分析、継続的改善
4. **クラス拡張への備え** → 階層型分類、バージョン管理、ライフサイクル管理
5. **LLM活用の可能性** → 補助的活用、コスト考慮、適切な用途選択

### 重要な考え方

画像認識プロジェクトは、一度モデルを作って終わりではなく、運用しながら継続的に精度を高めていく長丁場の取り組みです。

幸いAzure Custom Visionは使い勝手が良く、改善サイクルを回しやすいプラットフォームです。

本記事で紹介した工夫を凝らしつつ、ぜひ**自社のユースケースに適した最適解**を模索してみてください。

---

**参考文献・情報源:** Azure Custom Vision ドキュメント、Microsoft Learn、各種ブログ・QAサイトでの事例など。
